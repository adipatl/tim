"use strict";ons.bootstrap().service("PhoneGapService",function(){return{alert:function(e){navigator&&navigator.notification.alert(e)},pickContact:function(e){if("function"==typeof e)if(navigator&&navigator.contacts){var t={};navigator.contacts.pickContact(function(n){if(t.name=function(e){if(!e)return null;if(e.displayName&&e.displayName.length>0)return e.displayName;var t="";return e.name&&(e.name.givenName&&e.name.givenName.length>0&&(t+=e.name.givenName),e.name.familyName&&e.name.familyName.length>0&&(t.length>0&&(t+=" "),t+=e.name.familyName)),t}(n),null===n.emails||void 0===n.emails||n.emails.length<=0)navigator.notification.alert("This contact has no email associated");else if(1===n.emails.length)t.email=n.emails[0].value,e(t);else if(n.emails.length>1){for(var o=[],a=0;a<n.emails.length;++a)o.push(n.emails[a].value);navigator.notification.confirm("Please select email for this customer",function(o){o&&o>0&&(t.email=n.emails[o-1].value,e(t))},"Select email",o)}},function(e){console.log("Error: "+e)})}else console.log("cordova is not loaded")}}}).service("ConfigService",function(){return{getUrl:function(e,t){var n,o="";t&&(o=t.employeeId,n=t.contacts);var a="";"training"===e?a="http://data-capture.financial.thomsonreuters.com/go?iv=t4cqtyisrcp9&q11="+o:"meeting"===e?a="http://data-capture.financial.thomsonreuters.com/go?iv=384s5oqum0qd6&q2="+o:"opportunity"===e?a="http://data-capture.financial.thomsonreuters.com/go?iv=2bsqu91m0xhbo":"clientfeedback"===e?a="http://data-capture.financial.thomsonreuters.com/go?iv=1s5p8l5gk7w22&q2="+o:"contentenh"===e?a="http://data-capture.financial.thomsonreuters.com/go?iv=1wi4x8k9kn4z2&q2="+o:"productenh"===e&&(a="http://data-capture.financial.thomsonreuters.com/go?iv=3hh23k27tplyw&q2="+o);for(var i=1;i<n.length+1;++i)a=a+"&q"+i+"="+n[i-1].email;return a},getTitle:function(e){return"training"===e?"Training Event":"meeting"===e?"Meeting Event":"opportunity"===e?"Opportunity Event":"clientfeedback"===e?"Client Feedback":"contentenh"===e?"Content Enhancement":"productenh"===e?"Product Enhancement":""}}}).service("ContactService",["PhoneGapService",function(e){var t=[];return{add:function(e,n){t.push(n),e.$apply()},remove:function(e,n){e.carousel[n].prev({animation:"none"}),t.splice(n,1)},reset:function(e){t.length=0,e.$apply()},selectedContacts:t,pickContact:function(t,n){"function"==typeof t&&e.pickContact(function(e){console.log(e),t(e)})}}}]).controller("MailController",["$scope","ContactService","ConfigService",function(e,t,n){e.remove=function(n){t.remove(e,n)},e.selectedContacts=t.selectedContacts,e.maxSupportedItem=1,e.pickContact=function(){t.pickContact(function(n){t.add(e,n)})},e.submit=function(){var e=window.localStorage;console.log(e.getItem("tim-employeeId"));var o=document.getElementById("content"),a=n.getUrl(o.topPage.data.content.nextPageId,{employeeId:e.getItem("tim-employeeId"),contacts:t.selectedContacts});window.open(a,"_system")};this.init=function(n){console.log("init - mail");var o=document.getElementById("content");console.log("data: "+JSON.stringify(o.topPage.data)),e.maxSupportedItem=1,o.topPage.data.content.maxItem&&(e.maxSupportedItem=parseInt(o.topPage.data.content.maxItem)),t.reset(e)},e.getTitleLabel=function(){var e=document.getElementById("content").topPage.data.content.nextPageId;return n.getTitle(e)}}]),document.addEventListener("init",function(e){var t,n="tim-employeeId",o=function(e,t){window.localStorage.setItem(e,t)},a=function(e){console.log("go to "+e),document.querySelector("#myNavigator").pushPage(e)},i=function(e){console.log("reset to "+e),document.querySelector("#myNavigator").resetToPage(e)},c=(t=n,window.localStorage.getItem(t)),l=document.querySelector("#myNavigator");l&&l.topPage&&(l.topPage.onDeviceBackButton=function(e){i("login.html")});var r=document.querySelector("#content");r&&r.topPage&&(r.topPage.onDeviceBackButton=function(e){i("login.html")});var m=e.target;if("login"===m.id){var u=document.getElementById("loggingInElement");if("string"==typeof c&&c.length>0)return u.show(),void setTimeout(function(){a("landing.html")},100);var g=document.getElementById("employee-id"),s=document.getElementById("next");g.onkeyup=function(e){s.disabled=g.value.length<=0},s.onclick=function(e){o(n,g.value),u.show(),a("landing.html")}}else{if(m.id.startsWith("content")){var d=document.getElementById("menu"),f=document.getElementById("menu-button"),p=document.getElementById("menu-home"),v=document.getElementById("menu-reset");f&&(f.onclick=function(e){d.open()}),p&&(p.onclick=function(e){i("login.html")}),v&&(v.onclick=function(e){o(n,""),i("login.html")})}var h=function(e){var t=e.srcElement.dataset.nextPage+".html",n=e.srcElement.dataset,o=document.getElementById("content"),a=document.getElementById("menu"),i={data:{content:n}};o.resetToPage(t,i).then(a.close.bind(a))};if("content-home"===m.id)for(var y=document.getElementsByTagName("ons-button"),I=0;I<y.length;I++)y[I].onclick=h}});